Address Resolution Protocol
протокол преобразования адресов (стандарт RFC 826)

чтобы пакет достиг пункта назначения необходимо знать IP-адрес получателя и MAC-адрес ближайшего маршрутизатора. ARP позволяет выяснить MAC-адрес соседа. устройство отправляет широковещательный запрос, на который отвечает только тот, кому принадлежит искомый IP-адрес.[^1]
очень многие сетевые устройства сохраняют в памяти МАС адреса устройств, с которыми обменивались данными, то есть создается таблица ассоциативной памяти, которая динамически обновляется.[^2]
# структура arp-пакета
пакет содержит следующую информацию:
- Тип оборудования (Hardware Туре)
- Тип протокола (Protocol Туре)
- Длина физического адреса (Hardware Address Length)
- Длина протокольного адреса (Protocol Address Length)
- Операция (Operation)
- Физический адрес отправителя (Sender Hardware Address)
- Протокольный адрес отправителя (Sender Protocol Address)
- Физический адрес получателя (Target Hardware Address)
- Протокольный адрес получателя (Target Protocol Address)
# уязвимость
 отравление ARP происходит, когда злоумышленник отправляет поддельные ARP-сообщения с целью связать свой MAC-адрес с IP-адресом целевого устройства. это может привести к атакам типа "Человек посередине" (MITM), при которых злоумышленник может перехватывать, изменять или блокировать трафик, предназначенный для целевого устройства. для предотвращения атак с отравлением ARP организации могут внедрять меры безопасности: статические записи ARP, динамическая проверка ARP и обеспечение обновления сетевых устройств.[^3] ![](pics/arp-cache.jpg)

[^1]: https://imvk.net/cisco/urok-24-protokol-arp
[^2]: Крис Сандерс «Анализ пакетов: практическое руководство по использованию Wireshark и tcpdump для решения реальных проблем в локальных сетях» - СПб. : ООО "Диалектика", 2019. стр. 170
[^3]: https://roadmap.sh/cyber-security